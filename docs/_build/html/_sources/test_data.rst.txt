Данные, полученные после обучения
========================================

В результате обучения модели ИИ, способной распознавать и выделять боксом маркер на протяжении всего обрабатываемого видео (точность определения указывается над боксом). С результатом можно ознакомиться во вкладке “Размеченные видео”.

Ниже представлены сводные таблицы характеристик, полученных в ходе обучения моделей.

- **train/box_loss**,  **train/obj_loss**, **train/cls_loss** - учебные потери
- **val/box_loss**, **val/obj_loss**, **val/cls_loss** - потери при валидации
- **metrics/precision** - доля релевантных экземпляров среди извлеченных экземпляров.
- **metrics/recall** - доля релевантных экземпляров, которые были извлечены.
- **metrics/mAP_0.5** - Mean Average Precision (усредненная средняя точность)
- **metrics/mAP_0.5:0.95** - среднее значение mAP по разным порогам IoU, от 0,5 до 0,95, шаг 0,05


.. table:: YOLOv5 (15 epohs, dataset ~6000)

    +-------+----------------+----------------+----------------+-------------------+----------------+-----------------+----------------------+--------------+--------------+--------------+-----------+-----------+----------+
    | epoch | train/box_loss | train/obj_loss | train/cls_loss | metrics/precision | metrics/recall | metrics/mAP_0.5 | metrics/mAP_0.5:0.95 | val/box_loss | val/obj_loss | val/cls_loss | x/lr0     | x/lr1     | x/lr2    |
    +=======+================+================+================+===================+================+=================+======================+==============+==============+==============+===========+===========+==========+
    | 0     | 0.06614        | 0.024384       | 0              | 0.81835           | 0.7892         | 0.7095          | 0.47805              | 0.035513     | 0.015257     | 0            | 0.0033267 | 0.0033267 | 0.070059 |
    +-------+----------------+----------------+----------------+-------------------+----------------+-----------------+----------------------+--------------+--------------+--------------+-----------+-----------+----------+
    | 1     | 0.041184       | 0.015834       | 0              | 0.8134            | 0.7898         | 0.74921         | 0.40143              | 0.040589     | 0.011798     | 0            | 0.0062205 | 0.0062205 | 0.03962  |
    +-------+----------------+----------------+----------------+-------------------+----------------+-----------------+----------------------+--------------+--------------+--------------+-----------+-----------+----------+
    | 2     | 0.035894       | 0.013939       | 0              | 0.8257            | 0.83356        | 0.76154         | 0.54867              | 0.026407     | 0.011339     | 0            | 0.0086743 | 0.0086743 | 0.0087403|
    +-------+----------------+----------------+----------------+-------------------+----------------+-----------------+----------------------+--------------+--------------+--------------+-----------+-----------+----------+
    | 3     | 0.029626       | 0.012683       | 0              | 0.82969           | 0.81969        | 0.77836         | 0.56598              | 0.024694     | 0.011263     | 0            | 0.00802   | 0.00802   | 0.00802  |
    +-------+----------------+----------------+----------------+-------------------+----------------+-----------------+----------------------+--------------+--------------+--------------+-----------+-----------+----------+
    | 4     | 0.025252       | 0.012081       | 0              | 0.83354           | 0.83798        | 0.78002         | 0.61074              | 0.019573     | 0.010555     | 0            | 0.00802   | 0.00802   | 0.00802  |
    +-------+----------------+----------------+----------------+-------------------+----------------+-----------------+----------------------+--------------+--------------+--------------+-----------+-----------+----------+
    | 5     |0.022084        | 0.01146        | 0              | 0.84888           | 0.81794        | 0.79772         | 0.6739               | 0.018206     | 0.010172     | 0            | 0.00736   | 0.00736   | 0.00736  |
    +-------+----------------+----------------+----------------+-------------------+----------------+-----------------+----------------------+--------------+--------------+--------------+-----------+-----------+----------+
    | 6     | 0.020321       | 0.011324       | 0              | 0.84237           | 0.82397        | 0.79204         | 0.69258              | 0.017073     | 0.01004      | 0            | 0.0067    | 0.0067    | 0.0067   |
    +-------+----------------+----------------+----------------+-------------------+----------------+-----------------+----------------------+--------------+--------------+--------------+-----------+-----------+----------+
    | 7     | 0.018309       | 0.010597       | 0              | 0.84333           | 0.82578        | 0.80487         | 0.70405              | 0.016252     | 0.010063     | 0            | 0.00604   | 0.00604   | 0.00604  |
    +-------+----------------+----------------+----------------+-------------------+----------------+-----------------+----------------------+--------------+--------------+--------------+-----------+-----------+----------+
    | 8     | 0.017315       | 0.01053        | 0              | 0.82              | 0.85712        | 0.81082         | 0.70478              | 0.016422     | 0.0098283    | 0            | 0.00538   | 0.00538   | 0.00538  |
    +-------+----------------+----------------+----------------+-------------------+----------------+-----------------+----------------------+--------------+--------------+--------------+-----------+-----------+----------+
    | 9     | 0.01607        | 0.010372       | 0              | 0.84662           | 0.8222         | 0.80401         | 0.71375              | 0.014919     | 0.0098008    | 0            | 0.00472   | 0.00472   | 0.00472  |
    +-------+----------------+----------------+----------------+-------------------+----------------+-----------------+----------------------+--------------+--------------+--------------+-----------+-----------+----------+
    | 10    | 0.015023       | 0.010106       | 0              | 0.83547           | 0.84059        | 0.81548         | 0.72177              | 0.014701     | 0.0097387    | 0            | 0.00406   | 0.00406   | 0.00406  |
    +-------+----------------+----------------+----------------+-------------------+----------------+-----------------+----------------------+--------------+--------------+--------------+-----------+-----------+----------+
    | 11    | 0.013952       | 0.010024       | 0              | 0.84281           | 0.83624        | 0.81397         | 0.73034              | 0.014431     | 0.0096699    | 0            | 0.0034    | 0.0034    | 0.0034   |
    +-------+----------------+----------------+----------------+-------------------+----------------+-----------------+----------------------+--------------+--------------+--------------+-----------+-----------+----------+
    | 12    | 0.013611       | 0.0098501      | 0              | 0.8329            | 0.84233        | 0.81313         | 0.73521              | 0.014181     | 0.009642     | 0            | 0.00274   | 0.00274   | 0.00274  |
    +-------+----------------+----------------+----------------+-------------------+----------------+-----------------+----------------------+--------------+--------------+--------------+-----------+-----------+----------+
    | 13    | 0.012893       | 0.0095891      | 0              | 0.83651           | 0.83798        | 0.81462         | 0.74059              | 0.013889     | 0.0095718    | 0            | 0.00208   | 0.00208   | 0.00208  |
    +-------+----------------+----------------+----------------+-------------------+----------------+-----------------+----------------------+--------------+--------------+--------------+-----------+-----------+----------+
    | 14    | 0.012565       | 0.0094591      | 0              | 0.83062           | 0.84582        | 0.81314         | 0.73866              | 0.013838     | 0.0096069    | 0            | 0.00142   | 0.00142   | 0.00142  |
    +-------+----------------+----------------+----------------+-------------------+----------------+-----------------+----------------------+--------------+--------------+--------------+-----------+-----------+----------+


Графики
==========

.. figure:: pictures/нормал_мап.png
       :scale: 100 %
       :align: center
       :alt: alternate text

       metrics/mAP_0.5

.. figure:: pictures/нормал_метрикс.png
       :scale: 100 %
       :align: center
       :alt: alternate text

       metrics/precision

.. figure:: pictures/нормал_рекол.png
       :scale: 100 %
       :align: center
       :alt: alternate text

       metrics/recall
